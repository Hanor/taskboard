<!--
  [LICENSE]
  Taskboard
  - - -
  Copyright (C) 2015 - 2016 Objective Solutions
  - - -
  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU Affero General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.
  
  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.
  
  You should have received a copy of the GNU Affero General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  [/LICENSE]
  -->
<!doctype html>
<html lang="">
<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<head>
    <meta charset="utf-8"/>
    <meta name="description" content=""/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="generator" content="TaskBoard"/>
    <title>TaskBoard</title>
    <!-- Place favicon.ico in the `app/` directory -->

    <!-- Chrome for Android theme color -->
    <meta name="theme-color" content="#303F9F"/>

    <!-- Web Application Manifest -->
    <link rel="manifest" href="/static/manifest.json"/>

    <!-- Tile color for Win8 -->
    <meta name="msapplication-TileColor" content="#3372DF"/>

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes"/>
    <meta name="application-name" content="PSK"/>
    <link rel="icon" sizes="192x192" href="/static/images/touch/chrome-touch-icon-192x192.png"/>

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
    <meta name="apple-mobile-web-app-title" content="TaskBoard"/>
    <link rel="apple-touch-icon" href="/static/images/touch/apple-touch-icon.png"/>

    <!-- Tile icon for Win8 (144x144) -->
    <meta name="msapplication-TileImage" content="/static/images/touch/ms-touch-icon-144x144-precomposed.png"/>

</head>

<style>
    @font-face {
        font-family: 'Roboto';
        src: url('/static/bower_components/font-roboto/RobotoTTF/Roboto-Light.ttf') format('truetype');
        font-weight: 300;
    }

    @font-face {
        font-family: 'Roboto';
        src: url('/static/bower_components/font-roboto/RobotoTTF/Roboto-LightItalic.ttf') format('truetype');
        font-weight: 300;
        font-style: italic;
    }

    @font-face {
        font-family: 'Roboto';
        src: url('/static/bower_components/font-roboto/RobotoTTF/Roboto-Regular.ttf') format('truetype');
        font-weight: 400;
    }

    @font-face {
        font-family: 'Roboto';
        src: url('/static/bower_components/font-roboto/RobotoTTF/Roboto-Italic.ttf') format('truetype');
        font-weight: 400;
        font-style: italic;
    }

    @font-face {
        font-family: 'Roboto';
        src: url('/static/bower_components/font-roboto/RobotoTTF/Roboto-Medium.ttf') format('truetype');
        font-weight: 500;
    }

    @font-face {
        font-family: 'Roboto';
        src: url('/static/bower_components/font-roboto/RobotoTTF/Roboto-MediumItalic.ttf') format('truetype');
        font-weight: 500;
        font-style: italic;
    }

    @font-face {
        font-family: 'Roboto';
        src: url('/static/bower_components/font-roboto/RobotoTTF/Roboto-Bold.ttf') format('truetype');
        font-weight: 700;
    }

    @font-face {
        font-family: 'Roboto';
        src: url('/static/bower_components/font-roboto/RobotoTTF/Roboto-BoldItalic.ttf') format('truetype');
        font-weight: 700;
        font-style: italic;
    }

    *, *:after, *:before {
        -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
        box-sizing: border-box;
    }

    body {
        background: #FFF;
        font-family: 'Roboto', 'Helvetica Neue', Helvetica, Arial, sans-serif;
        color: #333;
        overflow: hidden;
    }
</style>

<body>

    <div class="login">

        <div id="login__header">
            <h1 class="login__title">
                Taskboard
            </h1>
        </div>

        <form class="login__form form">
            <div class="form__error"></div>
            <div class="form__fields">
                <div class="form__row">
                    <label class="form__label" for="username">Username</label>
                    <input class="form__input-text" type="text" id="username" name="username" />
                </div>
                <div class="form__row">
                    <label class="form__label" for="password">Password</label>
                    <input class="form__input-text" type="password" id="password" name="password" />
                </div>
            </div>
            <div class="form__submit">
                <button class="form__submit-button">Login</button>
            </div>
        </form>

    </div>

    <script>
        var form  = document.querySelector('form');
        var username = document.querySelector('#username');
        var password = document.querySelector('#password');
        var error = document.querySelector('.form__error');

        form.addEventListener('submit', onSubmit);

        function onSubmit(event) {
            event.preventDefault();
            setError('');
            if (username.value === '' || password.value === '') {
                setError('Username and Password are required');
                return false;
            }
            requestLogin();
        }

        function requestLogin() {
            clearStorages();

            var httpRequest = new XMLHttpRequest();
            var url = '/login';
            httpRequest.open('POST', url, true);
            httpRequest.onload = function(progressEvent) {
                if (progressEvent.target.status === 200) {
                    window.location = "/";
                } else {
                    var errorObj = JSON.parse(progressEvent.target.responseText);
                    setError(errorObj.message);
                }
            };
            httpRequest.send(new FormData(form));
        }

        function clearStorages() {
            localStorage.clear();
            sessionStorage.clear();
        }

        function setError(errorMessage) {
            error.innerHTML = errorMessage;
        }

    </script>

</body>

</html>